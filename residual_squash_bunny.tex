
\begin{tikzpicture}
    \begin{groupplot}[
        group style={
            group size=1 by 2,  % 改为1列2行
            vertical sep=1.5cm  % 改用垂直间距
        },
        width=8.4cm,
        grid=major,
        ymode=log,
        log origin=infty,
    ]
    
    % 第一个子图（原有的迭代次数-残差图）
    \nextgroupplot[
        ymax=1e1,
        ymin=1e-6,
        ymode=log,
        log origin=infty,
        restrict y to domain=-inf:100,
        legend columns=4,
        legend style={
            at={(0.5,-1.5)},
            anchor=north,
            font=\footnotesize,
            align=left,
            cells={anchor=west},
            % /tikz/every even column/.append style={column sep=0.5cm}  % 列间距
        },
        xlabel={Iteration Number},
        ylabel={Relative Residual},
        xlabel style={font=\footnotesize},
        ylabel style={font=\footnotesize},
        tick label style={font=\footnotesize},
        enlarge y limits=0.1
    ]
    
    % 5K - 红色系
    \addplot+[red, thick, solid, mark=*, mark repeat=50] 
        table[x=Iter,y=Residual] {./data/processed/residual_squash_bunny_5K_amg.txt};
    \addlegendentry{5K AMG}
    \addplot+[red, thick, solid, mark=square*, no markers] 
        table[x=Iter,y=Residual] {./data/processed/residual_squash_bunny_5k_xpbd.txt};
    \addlegendentry{5K XPBD}
    
    % 12K - 蓝色系
    \addplot+[blue, thick, solid, mark=triangle, mark repeat=50] 
        table[x=Iter,y=Residual] {./data/processed/residual_squash_bunny_12K_amg.txt};
    \addlegendentry{12K AMG}
    \addplot+[blue, thick, solid, mark=diamond*, no markers] 
        table[x=Iter,y=Residual] {./data/processed/residual_squash_bunny_12k_xpbd.txt};
    \addlegendentry{12K XPBD}
    
    % 270K - 绿色系
    \addplot+[green!50!black, thick, solid, mark=pentagon, mark repeat=50] 
        table[x=Iter,y=Residual] {./data/processed/residual_squash_bunny_270K_amg.txt};
    \addlegendentry{270K AMG}
    \addplot+[green!50!black, thick, solid, mark=oplus*, no markers] 
        table[x=Iter,y=Residual] {./data/processed/residual_squash_bunny_270k_xpbd.txt};
    \addlegendentry{270K XPBD}
    
    % 850K - 紫色系
    \addplot+[yellow!40!black, thick, solid, mark=star, mark repeat=50] 
        table[x=Iter,y=Residual] {./data/processed/residual_squash_bunny_850k_amg.txt};
    \addlegendentry{850K AMG}
    \addplot+[yellow!40!black, thick, solid, mark=Mercedes star, no markers] 
    table[x=Iter,y=Residual] {./data/processed/residual_squash_bunny_850k_xpbd.txt};
    \addlegendentry{850K XPBD}
    
    % 第二个子图（时间-残差图）
    \nextgroupplot[
        ymax=2,
        ymin=1e-2,
        ymode=log,
        xmax=0.8e4,
        restrict y to domain=-inf:100,
        legend columns=4,
        legend style={
            at={(0.5,-0.2)},
            anchor=north,
            font=\footnotesize,
            align=left,
            cells={anchor=west},
            /tikz/every even column/.append style={column sep=0.5cm}
        },
        xlabel={Time (ms)},
        ylabel={Relative Residual},
        xlabel style={font=\footnotesize},
        ylabel style={font=\footnotesize},
        tick label style={font=\footnotesize}
    ]
    
    % 5K - 红色系
    \addplot+[red, thick, solid, mark=*, mark repeat=5] 
        table[x=Time,y=Residual] {./data/processed/residual_squash_bunny_5K_amg_time.txt};
    \addlegendentry{5K AMG}
    \addplot+[red, thick, solid, no markers] 
        table[x=Time,y=Residual] {./data/processed/residual_squash_bunny_5k_xpbd_time.txt};
    \addlegendentry{5K XPBD}
    
    % 12K - 蓝色系
    \addplot+[blue, thick, solid, mark=triangle, mark repeat=5] 
        table[x=Time,y=Residual] {./data/processed/residual_squash_bunny_12K_amg_time.txt};
    \addlegendentry{12K AMG}
    \addplot+[blue, thick, solid, no markers] 
        table[x=Time,y=Residual] {./data/processed/residual_squash_bunny_12k_xpbd_time.txt};
    \addlegendentry{12K XPBD}
    
    % 270K - 绿色系
    \addplot+[green!50!black, thick, solid, mark=pentagon, mark repeat=5] 
        table[x=Time,y=Residual] {./data/processed/residual_squash_bunny_270K_amg_time.txt};
    \addlegendentry{270K AMG}
    \addplot+[green!50!black, thick, solid, no markers] 
        table[x=Time,y=Residual] {./data/processed/residual_squash_bunny_270k_xpbd_time.txt};
    \addlegendentry{270K XPBD}
    
    % 850K - 紫色系
    \addplot+[yellow!40!black, thick, solid, mark=star, mark repeat=5] 
        table[x=Time,y=Residual] {./data/processed/residual_squash_bunny_850k_amg_time.txt};
    \addlegendentry{850K AMG}
    \addplot+[yellow!40!black, thick, solid, no markers] 
        table[x=Time,y=Residual] {./data/processed/residual_squash_bunny_850k_xpbd_time.txt};
    \addlegendentry{850K XPBD}

    % 隐藏第二个子图的图例
    \legend{}
    
    \end{groupplot}
\end{tikzpicture}